<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>snow</title>
    <link rel="stylesheet" href="css/normalize.css">
    <style type="text/css">
    canvas { position: absolute; top: 0; left: 0; background-color: #0086B3;}
    </style>
</head>
<body>
<h1>h1</h1>
<h2>h2</h2>
<h3>h3</h3>
<button>button</button>
<canvas id="Js_canvas"></canvas>
<script src="js/Kanvas.js"></script>
<script>
(function(){
    var K = Kanvas,
        width = window.innerWidth,
        height = window.innerHeight,
        canvas = K.getCanvas("#Js_canvas", {
            width: width,
            height: height
        }),
        ctx = canvas.getContext("2d");

    var snowflakeUrl = "img/Snowflakes.png";
    var snowflakeCollect = [];

    function generateSnowflake() {
        var random = Math.random();
        return {
            type: Math.round(random * 4),
            x: Math.round(width * random),
            y: 0,
            opacity: random,
            scale: random * 20,
            speedX: Math.round(3 * random),
            speedY: Math.round(3 * random)
        }
    }
    snowflakeCollect.push(generateSnowflake());

    function updateSnowflake(status){
        status.x = status.x + status.speedX;
        status.y = status.y + status.speedY;
    }


    function drawSnowflake(status) {
        var img = new Image();
        img.onload = function(){
            ctx.drawImage(this, status.type * 20, 0, 20, 20, status.x, status.y, status.scale, status.scale);
        }
        img.src = snowflakeUrl;
        snowflakeCollect.push(generateSnowflake());
        if (snowflakeCollect.length < 10) {
            snowflakeCollect.push(generateSnowflake());
        }
    }

    function frame(){
        ctx.clearRect(0, 0, width, height);
        snowflakeCollect.forEach(function(obj, index, array){
            updateSnowflake(obj);
            if (obj.y > height + obj.scale || obj.x < -obj.scale || obj.x > width + obj.scale) {
                array.splice(index, 1);
            }
            drawSnowflake(obj);
        });
        K.requestAnimationFrame.call(window, frame);
    }
    frame();
})();
</script>
</body>
</html>